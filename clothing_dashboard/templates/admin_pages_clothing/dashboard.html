{% extends 'base/base.html' %} 
{% block title %}Dashboard  {% endblock title%}
{% load static %} {% block content %}







  <div class="container-fluid py-4">
    
    <div class="row">
      <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
        <a href="{% url 'dashboard_app:sales_report' %}">
        <div class="card">
          
          <div class="card-body p-3">
            <div class="row">
              <div class="col-8">
                <div class="numbers">
                  <p class="text-sm mb-0 text-capitalize font-weight-bold">
                    Today's Money
                  </p>
                  <h5 class="font-weight-bolder mb-0">
                    {% comment %} ₹ {{total_money}} {% endcomment %}
                    <!-- {% comment %} <span class="text-success text-sm font-weight-bolder"
                      >0%</span
                    > {% endcomment %} -->
                  </h5>
                </div>
              </div>
              <div class="col-4 text-end">
                <div
                  class="icon icon-shape bg-gradient-primary shadow text-center border-radius-md"
                >
                  <i
                    class="ni ni-money-coins text-lg opacity-10"
                    aria-hidden="true"
                  ></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      </a>
      </div>
      <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
        <a href="">
        <div class="card">
          <div class="card-body p-3">
            <div class="row">
              <div class="col-8">
                <div class="numbers">
                  <p class="text-sm mb-0 text-capitalize font-weight-bold">
                    Total Customer's
                  </p>
                  <h5 class="font-weight-bolder mb-0">
                    {% comment %} {{total_customers}} {% endcomment %}
                    <!-- {% comment %} <span class="text-success text-sm font-weight-bolder"
                      >0%</span
                    > {% endcomment %} -->
                  </h5>
                </div>
              </div>
              <div class="col-4 text-end">
                <div
                  class="icon icon-shape bg-gradient-primary shadow text-center border-radius-md"
                >
                  <i
                    class="ni ni-world text-lg opacity-10"
                    aria-hidden="true"
                  ></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      </a>
      </div>
      <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
        <a href="">
        <div class="card">
          <div class="card-body p-3">
            <div class="row">
              <div class="col-8">
                <div class="numbers">
                  <p class="text-sm mb-0 text-capitalize font-weight-bold">
                    Orders Delivered
                  </p>
                  <h5 class="font-weight-bolder mb-0">
                    {% comment %} {{total_delivery_boys}} {% endcomment %}
                    <!-- {% comment %} <span class="text-danger text-sm font-weight-bolder"
                      >0%</span
                    > {% endcomment %} -->
                  </h5>
                </div>
              </div>
              <div class="col-4 text-end">
                <div
                  class="icon icon-shape bg-gradient-primary shadow text-center border-radius-md"
                >
                  <i
                    class="ni ni-paper-diploma text-lg opacity-10"
                    aria-hidden="true"
                  ></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      </a>
      </div>
      <div class="col-xl-3 col-sm-6">
        <a href="">
        <div class="card">
          <div class="card-body p-3">
            <div class="row">
              <div class="col-8">
                <div class="numbers">
                  <p class="text-sm mb-0 text-capitalize font-weight-bold">
                    Delivery Returned
                  </p>
                  <h5 class="font-weight-bolder mb-0">
                     {% comment %} {{total_orders_delivered}} {% endcomment %}
                    <!-- {% comment %} <span class="text-success text-sm font-weight-bolder"
                      >0%</span
                    > {% endcomment %} -->
                  </h5>
                </div>
              </div>
              <div class="col-4 text-end">
                <div
                  class="icon icon-shape bg-gradient-primary shadow text-center border-radius-md"
                >
                  <i
                    class="ni ni-cart text-lg opacity-10"
                    aria-hidden="true"
                  ></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      </a>
      </div>
    </div>

    
 

    <div class="row mt-4">
        <div class="col-lg-5 mb-lg-0 mb-4">
          <div class="card z-index-2">
            <div class="card-body p-3">
              <div class="bg-gradient-dark border-radius-lg py-3 pe-1 mb-3">
                <div class="chart">
                  <canvas
                    id="chart-bars"
                    class="chart-canvas"
                    height="170"
                  ></canvas>
                </div>
              </div>
              <h6 class="ms-2 mt-4 mb-0">Active Delivery</h6>
             

            </div>
          </div>
        </div>
        <div class="col-lg-7">
          <div class="card z-index-2">
            <div class="card-header pb-0">
              <h6>Sales overview</h6>
             
            </div>
            <div class="card-body p-3">
              <div class="chart">
                <canvas
                  id="chart-line"
                  class="chart-canvas"
                  height="300"
                ></canvas>
              </div>
            </div>
          </div>
        </div>
      </div>


        <!-- Your updated HTML structure with offcanvas -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="ordersModal" aria-labelledby="ordersModalLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="ordersModalLabel">Orders</h5>
    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body">
    <div class="row">
      <!-- Column for Processing Orders -->
      <h1>Orders</h1>
      <div class="col-md-4" id="processingOrders">
        <!-- Cards for processing orders -->
      </div>
      <!-- Columns for Ready to Delivery and New Orders -->
      <!-- ... (other columns and cards) -->
    </div>
  </div>


      </div>
    <footer class="footer pt-3">
      <div class="container-fluid">
        <div class="row align-items-center justify-content-lg-between">
          <div class="col mb-lg-0 mb-4">
            <div class="copyright text-center text-sm text-muted text-lg-start">
              ©
              <script>
                document.write(new Date().getFullYear());
              </script>
              VFF Group
            </div>
          </div>
          
        </div>
      </div>
    </footer>
  </div>



  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="{% static 'js/plugins/chartjs.min.js' %}"></script>
  <script>
    var ctx = document.getElementById("chart-bars").getContext("2d");

    
// Function to convert numeric month to abbreviated month name with year
function getMonthWithYear(monthYearString) {
const [year, month] = monthYearString.split('-');
const monthNames = [
  "Jan", "Feb", "Mar", "Apr", "May", "Jun",
  "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
];
return `${monthNames[parseInt(month) - 1]} ${year}`;
}
// Function to update the chart with data
function updateChart(data) {
var labels = data.map(item => getMonthWithYear(item.current_month));
var counts = data.map(item => item.current_month_count);
var previousCounts = data.map(item => item.previous_month_count);
var percentageIncreases = data.map(item => item.percentage_increase);

new Chart(ctx, {
  type: "bar",
  data: {
    labels: labels,
    datasets: [
      {
        label: "Completed Orders",
        tension: 0.4,
        borderWidth: 0,
        borderRadius: 4,
        borderSkipped: false,
        backgroundColor: "#fff",
        data: counts,
        maxBarThickness: 6,
      },
    ],
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      legend: {
        display: false,
      },
    },
    interaction: {
      intersect: false,
      mode: "index",
    },
    scales: {
      y: {
        grid: {
          drawBorder: false,
          display: false,
          drawOnChartArea: false,
          drawTicks: false,
        },
        ticks: {
          suggestedMin: 0,
          suggestedMax: Math.max(...counts) + 5, // Adjusted based on the maximum value in the data
          beginAtZero: true,
          padding: 15,
          font: {
            size: 14,
            family: "Open Sans",
            style: "normal",
            lineHeight: 2,
          },
          color: "#fff",
        },
      },
      x: {
        grid: {
          drawBorder: false,
          display: false,
          drawOnChartArea: false,
          drawTicks: false,
        },
        ticks: {
          display: false,
        },
      },
    
      },
  },
});
}


// Create the chart
var ctx2 = document.getElementById("chart-line").getContext("2d");

var gradientStroke1 = ctx2.createLinearGradient(0, 230, 0, 50);
gradientStroke1.addColorStop(1, "rgba(203,12,159,0.2)");
gradientStroke1.addColorStop(0.2, "rgba(72,72,176,0.0)");
gradientStroke1.addColorStop(0, "rgba(203,12,159,0)"); //purple colors

var gradientStroke2 = ctx2.createLinearGradient(0, 230, 0, 50);
gradientStroke2.addColorStop(1, "rgba(20,23,39,0.2)");
gradientStroke2.addColorStop(0.2, "rgba(72,72,176,0.0)");
gradientStroke2.addColorStop(0, "rgba(20,23,39,0)"); //purple colors

var salesChart = new Chart(ctx2, {
  type: "line",
  data: {
      labels: [], // Will be dynamically set
      datasets: [], // Will be dynamically set
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      legend: {
        display: false,
      },
    },
    interaction: {
      intersect: false,
      mode: "index",
    },
    scales: {
      y: {
        grid: {
          drawBorder: false,
          display: true,
          drawOnChartArea: true,
          drawTicks: false,
          borderDash: [5, 5],
        },
        ticks: {
          display: true,
          padding: 10,
          color: "#b2b9bf",
          font: {
            size: 11,
            family: "Open Sans",
            style: "normal",
            lineHeight: 2,
          },
        },
      },
      x: {
        grid: {
          drawBorder: false,
          display: false,
          drawOnChartArea: false,
          drawTicks: false,
          borderDash: [5, 5],
        },
        ticks: {
          display: true,
          color: "#b2b9bf",
          padding: 20,
          font: {
            size: 11,
            family: "Open Sans",
            style: "normal",
            lineHeight: 2,
          },
        },
      },
    },
  },

});

</script>
<!-- <script src="https://www.gstatic.com/firebasejs/9.6.8/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.8/firebase-messaging.js"></script>
<script src='https://cdn.firebase.com/js/client/2.2.1/firebase.js'></script> -->



<script>
  $(document).ready(function() {
  // Function to fetch and display orders status
  function fetchOrdersStatus() {
   var myOffcanvas = new bootstrap.Offcanvas(document.getElementById('ordersModal'));
        myOffcanvas.show();// Show the modal after data is loaded
  }

  // Call the function when the screen loads
  //fetchOrdersStatus();
});

</script>

{% endblock %}
